---
title: 'Python SDK'
description: 'A Python SDK for node development'
icon: 'code'
---

<Info>
  **Prerequisite:** Python version 3.12 or higher.
</Info>

1. ## Install the Python SDK on your OS


```bash
pip install openagents-node-sdk
```

2. ## Create a runner

- Templates are based on the [NIP-01 implementation](https://github.com/nostr-protocol/nips/blob/master/01.md).

- A template must follow the [NIP-90 implementation](https://github.com/nostr-protocol/nips/blob/master/90.md).

Node example [here](https://github.com/OpenAgentsInc/openagents-node-python-sdk) ("RunnerConfig" code block):

The runner class must be defined with all the parameters that are required by the NIPs.

- Definition of a runner class:

```bash
class MyRunner (JobRunner):
    def __init__(self):
        # Set the runner metadata, template and filter
        super().__init__(\
            RunnerConfig(
```

**Metadata** are required. You can set them in the "meta" object. This is general information about the node, so you can enter whatever you want.

The “kind” value should always be “5003”, as this is the standard currently adopted by OpenAgents.

```bash
meta={
    "kind":5003,
    "name":"My Action",
    "description":"This is a new action"
    "tos": "https://example.com/tos",
    "privacy": "https://example.com/privacy",
    "picture": "https://example.com/icon.png",
    "tags": ["tag1","tag2"]
    "website": "https://example.com",
    "author": "John Doe",
},
```

**Filters** are used to fetch jobs.


```bash
filter={
    "filterByKind":5003,
    #AND
    "filterByRunOn": "my-new-action"
},
```
If you want to implement a worker for a standard nip-90 type job, like a kind [5050](https://github.com/nostr-protocol/data-vending-machines/blob/master/kinds/5050.md) (text generation), then you must filter by type. Standard type jobs have no "run-on".

In **template** there can be one or more inputs in the predefined tags:

    `["i", "{{value}}", "{{type}}", "",  "query"]`

There can also be 0 or more parameters, prefixed with param, then the key (name) and the value:

    `["param","run-on", "my-new-action" ]`

`run-on` is mandatory if and only if you create a 5003 event.

Events can be compiled with anything that is allowed in the [NIPs](https://github.com/nostr-protocol/nips).

```bash
template="""
{
    "kind": {{meta.kind}},
    "created_at": {{sys.timestamp_seconds}},
    "tags": [
        ["param","run-on", "my-new-action" ],
        ["param", "k", "{{in.k}}"],
        ["output" , "{{out.content}}"]
        {{#in.queries}}
        ["i", "{{value}}", "{{type}}", "",  "query"],
        {{/in.queries}}
        ["expiration", "{{sys.expiration_timestamp_seconds}}"],
    ],
    "content":""
}""",
```

**Socket** is in [json schema](https://json-schema.org/).

You must have a "socket in" dictionary for inputs and a "socket out" for ouputs.

In `in` you can put whatever you want. These are the event values. You can call them with `in.something`.

```bash
sockets={
    "in": {
        "k": {
            "title": "K",
            "description":"This is a number"
            "type":"integer",
            "default": 0,
        },
        "queries": {
            "title": "Queries",
            "type":"array",
            "description":"This is an array of queries",
            "items": {
                "type":"string"
            }
        }
    },
    "out": {
        "contentType": {
            "title": "Content Type",
            "type": "string",
            "description": "The content of the event",
            "default": "application/json"
        }
    }
}
```

3. ## Program the main logic of your node and initialize

[API documentation](https://openagentsinc.github.io/openagents-node-python-sdk/index.html) for the SDK methods.

### Initialize the runner class

The `init` method intitializes the runner class:

```bash
async def init(self, node):
       # Initialize class
       pass
```

### Execution methods

These methods receive as argument a `ctx` [JobContext](https://openagentsinc.github.io/openagents-node-python-sdk/JobContext.html) object.
The `ctx` object contains several methods that can be used to get useful informations related to the job (including inputs and parameters) and to comunicate with the pool's api, see [the documentation](https://openagentsinc.github.io/openagents-node-python-sdk/JobContext.html) for more details.

`canRun` is a filter. Can be used to perform checks before deciding whether to run the job (`bool`):

```bash
async def canRun(self,ctx):
        # Custom job filtering logic
        return True
```

`preRun` is a hook that runs before `run`. It can be useful depending on the case:

```bash
async def preRun(self, ctx):
        # Do something before running the job
        pass
```

`postRun` executes some code after the main logic in `run` has been executed. It can be useful depending on the case:

```bash
async def postRun(self, ctx):
        # Do something after running the job
        pass
```

`run` is the main method, the one on which the node's core logic must be implemented:

```bash
async def run(self,ctx):
        # Do something
        print("Running job",job.id)
        # Finish the job
        jobOutput=""
        return jobOutput
```

#### Parallel execution - Advanced

A single instance of the JobRunner is used to process each compatible job, by default this happens synchronously (ie. the next job will start after the end of the previous job).
It is possible to configure the runner to run the jobs in parallel by calling `self.setRunInParallel(True)` inside the `init` method.
*Note: Parallel runners should be written in valid non-blocking [asyncio](https://docs.python.org/3/library/asyncio.html) code*
